class m{static processedData=null;static loadingPromise=null;static async loadMitreDataAsync(){if(this.processedData)return this.processedData;if(this.loadingPromise)return this.loadingPromise;this.loadingPromise=this.fetchAndProcessData();const e=await this.loadingPromise;return this.processedData=e,e}static loadMitreData(){if(this.processedData)return this.processedData;const e=this.loadMitreDataSync();return this.processedData={tactics:e.tactics,techniques:e.techniques,software:e.software,groups:e.groups,tacticOrder:e.tacticOrder,techniquesByTactic:e.techniquesByTactic,softwareByType:e.softwareByType,softwareByTechnique:e.softwareByTechnique,techniquesBySoftware:e.techniquesBySoftware},this.processedData}static getTactics(){const e=this.loadMitreData();return e.tacticOrder.map(t=>e.tactics[t])}static getTechniquesForTactic(e){const t=this.loadMitreData(),s=(t.techniquesByTactic[e]||[]).map(i=>t.techniques[i]).filter(Boolean),r=s.filter(i=>i.type!=="pseudo_technique"),n=s.filter(i=>i.type==="pseudo_technique");return r.sort((i,o)=>i.name.localeCompare(o.name)),[...r,...n]}static getAllTechniques(){const e=this.loadMitreData();return Object.values(e.techniques)}static getSoftwareByType(e){const t=this.loadMitreData();return(e==="tool"?t.softwareByType.tools:t.softwareByType.malware).map(s=>t.software[s]).filter(Boolean)}static getAllSoftware(){const e=this.loadMitreData();return Object.values(e.software)}static getAllGroups(){const e=this.loadMitreData(),t=Object.values(e.groups),a=t.filter(r=>r.is_meta_group),s=t.filter(r=>!r.is_meta_group);return a.sort((r,n)=>n.external_id.localeCompare(r.external_id)),s.sort((r,n)=>r.name.localeCompare(n.name)),[...a,...s]}static getSoftwareForTechnique(e){const t=this.loadMitreData();return(t.softwareByTechnique[e]||[]).map(s=>t.software[s]).filter(Boolean)}static getTechniquesForSoftware(e){const t=this.loadMitreData();return(t.techniquesBySoftware[e]||[]).map(s=>t.techniques[s]).filter(Boolean)}static searchTechniques(e){const t=this.loadMitreData(),a=e.toLowerCase();return Object.values(t.techniques).filter(s=>s.name.toLowerCase().includes(a)||s.external_id.toLowerCase().includes(a)||s.description.toLowerCase().includes(a))}static searchSoftware(e){const t=this.loadMitreData(),a=e.toLowerCase();return Object.values(t.software).filter(s=>s.name.toLowerCase().includes(a)||s.external_id.toLowerCase().includes(a)||s.description.toLowerCase().includes(a))}static searchGroups(e){const t=this.loadMitreData(),a=e.toLowerCase();return Object.values(t.groups).filter(s=>s.name.toLowerCase().includes(a)||s.external_id.toLowerCase().includes(a)||s.description.toLowerCase().includes(a)||s.aliases&&s.aliases.some(r=>r.toLowerCase().includes(a)))}static getTechniqueById(e){return this.loadMitreData().techniques[e]||null}static getTacticById(e){return this.loadMitreData().tactics[e]||null}static getSoftwareById(e){return this.loadMitreData().software[e]||null}static getGroupById(e){return this.loadMitreData().groups[e]||null}static getTacticsForTechnique(e){const t=this.loadMitreData(),a=t.techniques[e];if(!a||!a.kill_chain_phases)return[];const s=a.kill_chain_phases.map(n=>n.phase_name),r=[];return Object.values(t.tactics).forEach(n=>{s.includes(n.x_mitre_shortname)&&r.push(n)}),r}static getDataStatistics(){const e=this.loadMitreData();return{totalTactics:Object.keys(e.tactics).length,totalTechniques:Object.keys(e.techniques).length,totalSoftware:Object.keys(e.software).length,totalGroups:Object.keys(e.groups).length,toolsCount:e.softwareByType.tools.length,malwareCount:e.softwareByType.malware.length,techniquesByCoverage:Object.entries(e.techniquesByTactic).map(([t,a])=>({tactic:e.tactics[t]?.name||t,techniqueCount:a.length}))}}static clearCache(){this.processedData=null,this.loadingPromise=null}static resolveUrl(e){if(e.startsWith("/src/data/")){const t="/ikb-demo/";return(t.endsWith("/")?t.slice(0,-1):t)+e}return e.startsWith("/"),e}static async fetchAndProcessData(){try{const t=this.resolveUrl("/src/data/mitre-attack-processed.json"),a=await fetch(t);if(!a.ok)throw new Error(`HTTP ${a.status}: ${a.statusText}`);const s=await a.json();return console.log("Successfully loaded full MITRE ATT&CK dataset:",{tacticsCount:Object.keys(s.tactics).length,techniquesCount:Object.keys(s.techniques).length,softwareCount:Object.keys(s.software).length,groupsCount:Object.keys(s.groups).length}),await this.loadAndMergeExtensions(s)}catch(e){console.warn("Failed to load mitre-attack-processed.json, using fallback data:",e);const t=this.loadMitreDataSync();return{tactics:t.tactics,techniques:t.techniques,software:t.software,groups:t.groups,tacticOrder:t.tacticOrder,techniquesByTactic:t.techniquesByTactic,softwareByType:t.softwareByType,softwareByTechnique:t.softwareByTechnique,techniquesBySoftware:t.techniquesBySoftware}}}static async loadAndMergeExtensions(e){try{const a=this.resolveUrl("/src/data/attack-extensions.json"),s=await fetch(a);if(!s.ok)return console.warn("Failed to load attack-extensions.json, continuing without extensions"),this.buildProcessedData(e);const r=await s.json();console.log("Successfully loaded attack extensions");const n={tactics:{...e.tactics},techniques:{...e.techniques},software:{...e.software},groups:{...e.groups},tacticOrder:[...e.tacticOrder],techniquesByTactic:{...e.techniquesByTactic},softwareByType:{...e.softwareByType},softwareByTechnique:{...e.softwareByTechnique},techniquesBySoftware:{...e.techniquesBySoftware}};if(r.techniques?.tactic_template){const i=r.techniques.tactic_template;Object.keys(n.tactics).forEach(o=>{const l=n.tactics[o],c=`N${o.substring(2)}`,u={id:c,name:i.technique.name,description:i.technique.description,external_id:c,kill_chain_phases:[{phase_name:l.x_mitre_shortname}],type:"pseudo_technique",sub_techniques:i.sub_techniques.map(d=>({...d,external_id:`${c}${d.id}`}))};n.techniques[c]=u,n.techniquesByTactic[o]||(n.techniquesByTactic[o]=[]),n.techniquesByTactic[o].push(c)})}return r.groups?.meta_groups&&r.groups.meta_groups.forEach(i=>{n.groups[i.id]={id:i.id,name:i.name,description:i.description,external_id:i.external_id,aliases:i.aliases||[],type:i.type,category:i.category,usage:i.usage,is_n_code:i.is_n_code,is_meta_group:i.is_meta_group}}),console.log("Successfully merged attack extensions:",{nCodeTechniques:Object.values(n.techniques).filter(i=>i.type==="pseudo_technique").length,metaGroups:Object.values(n.groups).filter(i=>i.is_meta_group).length}),this.buildProcessedData(n)}catch(t){return console.warn("Failed to load or merge extensions:",t),this.buildProcessedData(e)}}static buildProcessedData(e){return{tactics:e.tactics,techniques:e.techniques,software:e.software,groups:e.groups,tacticOrder:e.tacticOrder,techniquesByTactic:e.techniquesByTactic,softwareByType:e.softwareByType,softwareByTechnique:e.softwareByTechnique,techniquesBySoftware:e.techniquesBySoftware}}static getSoftwareBySelectedTechniques(e,t){const a=new Set;return Object.values(e).forEach(s=>{Object.entries(s).forEach(([r,n])=>{n&&t[r]&&t[r].forEach(i=>{a.add(i)})})}),Array.from(a)}static getSoftwareRecommendationScore(e,t,a){const s=a[e]||[];if(s.length===0)return 0;let r=0;const n=new Set;return Object.values(t).forEach(i=>{Object.entries(i).forEach(([o,l])=>{l&&n.add(o)})}),s.forEach(i=>{n.has(i)&&r++}),n.size>0?r/n.size:0}static loadMitreDataSync(){return{tactics:{TA0001:{id:"TA0001",name:"Initial Access",description:"The adversary is trying to get into your network.",external_id:"TA0001",x_mitre_shortname:"initial-access"},TA0002:{id:"TA0002",name:"Execution",description:"The adversary is trying to run malicious code.",external_id:"TA0002",x_mitre_shortname:"execution"},TA0003:{id:"TA0003",name:"Persistence",description:"The adversary is trying to maintain their foothold.",external_id:"TA0003",x_mitre_shortname:"persistence"},TA0004:{id:"TA0004",name:"Privilege Escalation",description:"The adversary is trying to gain higher-level permissions.",external_id:"TA0004",x_mitre_shortname:"privilege-escalation"},TA0005:{id:"TA0005",name:"Defense Evasion",description:"The adversary is trying to avoid being detected.",external_id:"TA0005",x_mitre_shortname:"defense-evasion"},TA0006:{id:"TA0006",name:"Credential Access",description:"The adversary is trying to steal account names and passwords.",external_id:"TA0006",x_mitre_shortname:"credential-access"},TA0007:{id:"TA0007",name:"Discovery",description:"The adversary is trying to figure out your environment.",external_id:"TA0007",x_mitre_shortname:"discovery"},TA0008:{id:"TA0008",name:"Lateral Movement",description:"The adversary is trying to move through your environment.",external_id:"TA0008",x_mitre_shortname:"lateral-movement"},TA0009:{id:"TA0009",name:"Collection",description:"The adversary is trying to gather data of interest to their goal.",external_id:"TA0009",x_mitre_shortname:"collection"},TA0010:{id:"TA0010",name:"Exfiltration",description:"The adversary is trying to steal data.",external_id:"TA0010",x_mitre_shortname:"exfiltration"},TA0011:{id:"TA0011",name:"Command and Control",description:"The adversary is trying to communicate with compromised systems to control them.",external_id:"TA0011",x_mitre_shortname:"command-and-control"},TA0040:{id:"TA0040",name:"Impact",description:"The adversary is trying to manipulate, interrupt, or destroy your systems and data.",external_id:"TA0040",x_mitre_shortname:"impact"}},techniques:{T1566:{id:"T1566",name:"Phishing",description:"Adversaries may send phishing messages to gain access to victim systems.",external_id:"T1566",kill_chain_phases:[{phase_name:"initial-access"}],x_mitre_platforms:["Linux","macOS","Windows"],x_mitre_version:"2.3"},T1059:{id:"T1059",name:"Command and Scripting Interpreter",description:"Adversaries may abuse command and script interpreters to execute commands, scripts, or binaries.",external_id:"T1059",kill_chain_phases:[{phase_name:"execution"}],x_mitre_platforms:["Linux","macOS","Windows"],x_mitre_version:"1.3"},T1547:{id:"T1547",name:"Boot or Logon Autostart Execution",description:"Adversaries may configure system settings to automatically execute a program during system boot or logon.",external_id:"T1547",kill_chain_phases:[{phase_name:"persistence"},{phase_name:"privilege-escalation"}],x_mitre_platforms:["Linux","macOS","Windows"],x_mitre_version:"1.1"},T1055:{id:"T1055",name:"Process Injection",description:"Adversaries may inject code into processes in order to evade process-based defenses.",external_id:"T1055",kill_chain_phases:[{phase_name:"defense-evasion"},{phase_name:"privilege-escalation"}],x_mitre_platforms:["Linux","macOS","Windows"],x_mitre_version:"1.3"},T1003:{id:"T1003",name:"OS Credential Dumping",description:"Adversaries may attempt to dump credentials to obtain account login and credential material.",external_id:"T1003",kill_chain_phases:[{phase_name:"credential-access"}],x_mitre_platforms:["Linux","macOS","Windows"],x_mitre_version:"1.4"},T1082:{id:"T1082",name:"System Information Discovery",description:"An adversary may attempt to get detailed information about the operating system and hardware.",external_id:"T1082",kill_chain_phases:[{phase_name:"discovery"}],x_mitre_platforms:["Linux","macOS","Windows"],x_mitre_version:"1.3"},T1021:{id:"T1021",name:"Remote Services",description:"Adversaries may use Valid Accounts to log into a service specifically designed to accept remote connections.",external_id:"T1021",kill_chain_phases:[{phase_name:"lateral-movement"}],x_mitre_platforms:["Linux","macOS","Windows"],x_mitre_version:"1.3"},T1005:{id:"T1005",name:"Data from Local System",description:"Adversaries may search local system sources, such as file systems and configuration files or local databases.",external_id:"T1005",kill_chain_phases:[{phase_name:"collection"}],x_mitre_platforms:["Linux","macOS","Windows"],x_mitre_version:"1.1"},T1041:{id:"T1041",name:"Exfiltration Over C2 Channel",description:"Adversaries may steal data by exfiltrating it over an existing command and control channel.",external_id:"T1041",kill_chain_phases:[{phase_name:"exfiltration"}],x_mitre_platforms:["Linux","macOS","Windows"],x_mitre_version:"1.0"},T1071:{id:"T1071",name:"Application Layer Protocol",description:"Adversaries may communicate using application layer protocols to avoid detection/network filtering.",external_id:"T1071",kill_chain_phases:[{phase_name:"command-and-control"}],x_mitre_platforms:["Linux","macOS","Windows"],x_mitre_version:"2.2"},T1486:{id:"T1486",name:"Data Encrypted for Impact",description:"Adversaries may encrypt data on target systems or on large numbers of systems in a network.",external_id:"T1486",kill_chain_phases:[{phase_name:"impact"}],x_mitre_platforms:["Linux","macOS","Windows"],x_mitre_version:"1.0"}},software:{S0154:{id:"S0154",name:"Cobalt Strike",description:"Cobalt Strike is a commercial, full-featured, penetration testing tool which bills itself as 'adversary simulation software designed to execute targeted attacks'.",external_id:"S0154",type:"tool",x_mitre_platforms:["Linux","macOS","Windows"]},S0002:{id:"S0002",name:"Mimikatz",description:"Mimikatz is a credential dumper capable of obtaining plaintext Windows account logins and passwords.",external_id:"S0002",type:"tool",x_mitre_platforms:["Windows"]},S0266:{id:"S0266",name:"TrickBot",description:"TrickBot is a Trojan spyware program that has mainly been used for targeting banking sites.",external_id:"S0266",type:"malware",x_mitre_platforms:["Windows"]}},groups:{G0016:{id:"G0016",name:"APT29",description:"APT29 is threat group that has been attributed to Russia's Foreign Intelligence Service.",external_id:"G0016",aliases:["APT29","YTTRIUM","The Dukes","Cozy Bear","CozyDuke"]},G0007:{id:"G0007",name:"APT28",description:"APT28 is a threat group that has been attributed to Russia's General Staff Main Intelligence Directorate (GRU) 85th Main Special Service Center (GTsSS) military unit 26165.",external_id:"G0007",aliases:["APT28","STRONTIUM","Fancy Bear","Sofacy","Sednit"]}},tacticOrder:["TA0001","TA0002","TA0003","TA0004","TA0005","TA0006","TA0007","TA0008","TA0009","TA0010","TA0011","TA0040"],techniquesByTactic:{TA0001:["T1566"],TA0002:["T1059"],TA0003:["T1547"],TA0004:["T1547","T1055"],TA0005:["T1055"],TA0006:["T1003"],TA0007:["T1082"],TA0008:["T1021"],TA0009:["T1005"],TA0010:["T1041"],TA0011:["T1071"],TA0040:["T1486"]},softwareByType:{tools:["S0154","S0002"],malware:["S0266"]},softwareByTechnique:{T1003:["S0002"],T1055:["S0154"],T1071:["S0154","S0266"]},techniquesBySoftware:{S0154:["T1055","T1071"],S0002:["T1003"],S0266:["T1071"]}}}}export{m as M};
