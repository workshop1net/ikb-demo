import{r as p,j as e}from"./index-BUBUI_qf.js";const se="/known_exploited_vulnerabilities.json",ne=/^CVE-\d{4}-\d{4,}$/i,ie=300,re=({value:t=[],onChange:l,placeholder:g="Enter CVE ID (e.g., CVE-2023-1234)",allowZeroDay:f=!0,maxEntries:y,disabled:$=!1,error:b,testId:A})=>{const[V,m]=p.useState(""),[u,N]=p.useState([]),[r,h]=p.useState(!1),[j,D]=p.useState(-1),[w,T]=p.useState(null),[U,O]=p.useState(!1),[z,k]=p.useState(""),[B,E]=p.useState(!1),[v,R]=p.useState({title:"",description:"",affectedSystems:"",discoveryDate:new Date().toISOString().split("T")[0],reporter:"",severity:"MEDIUM",mitigationSteps:""}),M=p.useRef(null),n=p.useRef(null),i=p.useRef(null);p.useEffect(()=>{a()},[]);const a=async()=>{try{O(!0);const s=await fetch(se);if(!s.ok)throw new Error(`CISA KEV fetch failed: ${s.status}`);const o=await s.json();T(o.vulnerabilities||[])}catch(s){console.error("Failed to load CISA KEV data:",s),T([])}finally{O(!1)}},d=s=>ne.test(s.trim()),c=s=>s.trim().toUpperCase(),x=s=>t.some(o=>o.id===s),S=s=>w&&w.find(o=>o.cveID===s)||null,I=p.useCallback(s=>{w&&(i.current&&clearTimeout(i.current),i.current=setTimeout(()=>{P(s)},ie))},[w]),P=s=>{if(!s.trim()||!w){N([]),h(!1);return}const o=s.toUpperCase(),L=w.filter(C=>C.cveID.includes(o)||C.vulnerabilityName.toUpperCase().includes(o)||C.product.toUpperCase().includes(o)).slice(0,10);N(L),h(L.length>0),D(-1)},F=s=>{const o=s.target.value;m(o),k(""),o.length>=3?I(o):h(!1)},Z=s=>{if(s.key==="Escape"){h(!1),D(-1);return}if(!r){s.key==="Enter"&&(s.preventDefault(),H());return}switch(s.key){case"ArrowDown":s.preventDefault(),D(o=>o<u.length-1?o+1:0);break;case"ArrowUp":s.preventDefault(),D(o=>o>0?o-1:u.length-1);break;case"Enter":s.preventDefault(),j>=0?Y(u[j]):H();break;case"Tab":j>=0&&(s.preventDefault(),Y(u[j]));break}},Y=s=>{m(s.cveID),h(!1),D(-1),setTimeout(()=>H(s.cveID),0)},H=s=>{const o=s||V.trim();if(!o){k("Please enter a CVE ID");return}if(!d(o)){k("Invalid CVE format. Use CVE-YYYY-NNNNN format");return}const L=c(o);if(x(L)){k("This CVE has already been added");return}if(y&&t.length>=y){k(`Maximum ${y} CVEs allowed`);return}const C=S(L),K={type:"cve",id:L,isKev:!!C,addedAt:new Date().toISOString(),title:C?.vulnerabilityName,description:C?.shortDescription,severity:"UNKNOWN"};l([...t,K]),m(""),k(""),h(!1),M.current?.focus()},q=s=>{l(t.filter(o=>o.id!==s))},ee=s=>{if(s.preventDefault(),!v.title.trim()||!v.description.trim())return;const o={type:"0-day",id:`0DAY-${Date.now()}`,addedAt:new Date().toISOString(),title:v.title,description:v.description,discoveryDate:v.discoveryDate,affectedSystems:v.affectedSystems?[v.affectedSystems]:[],severity:v.severity};l([...t,o]),E(!1),R({title:"",description:"",affectedSystems:"",discoveryDate:new Date().toISOString().split("T")[0],reporter:"",severity:"MEDIUM",mitigationSteps:""})},te=s=>{s.preventDefault();const L=s.clipboardData.getData("text").split(/[\s,\n]+/).map(K=>K.trim()).filter(K=>d(K));let C=0;L.forEach(K=>{const W=c(K);if(!x(W)&&(!y||t.length+C<y)){const G=S(W),ae={type:"cve",id:W,isKev:!!G,addedAt:new Date().toISOString(),title:G?.vulnerabilityName,description:G?.shortDescription,severity:"UNKNOWN"};t.push(ae),C++}}),C>0&&(l([...t]),k(`Added ${C} CVE(s)`))};return e.jsxs("div",{className:"cve-input-container","data-testid":A,children:[e.jsxs("div",{className:"cve-input-row",children:[e.jsxs("div",{className:"autocomplete-container",children:[e.jsx("input",{ref:M,type:"text",className:"cve-input-field",placeholder:g,value:V,onChange:F,onKeyDown:Z,onPaste:te,onBlur:()=>{setTimeout(()=>{n.current?.contains(document.activeElement)||h(!1)},200)},disabled:$,"aria-autocomplete":"list","aria-expanded":r,"aria-haspopup":"listbox"}),r&&e.jsx("div",{ref:n,className:"autocomplete-dropdown",role:"listbox","aria-label":"CVE suggestions",children:u.map((s,o)=>e.jsxs("div",{className:`autocomplete-item ${o===j?"selected":""}`,role:"option","aria-selected":o===j,onClick:()=>Y(s),onMouseEnter:()=>D(o),children:[e.jsxs("div",{className:"autocomplete-cve-id",children:[s.cveID,e.jsx("span",{className:"kev-badge",children:"KEV"})]}),e.jsx("div",{className:"autocomplete-description",children:s.vulnerabilityName})]},s.cveID))})]}),f&&e.jsx("button",{type:"button",className:"zeroday-button",onClick:()=>E(!0),disabled:$,title:"Report 0-day vulnerability",children:"ðŸ“‹ 0-day"})]}),(z||b)&&e.jsx("div",{className:"cve-validation-message",role:"alert",children:z||b}),U&&e.jsx("div",{className:"cve-loading",children:"Loading CISA KEV data..."}),e.jsx("div",{className:"cve-tags-container",children:t.map(s=>e.jsxs("div",{className:`cve-tag ${s.type==="0-day"?"zeroday":""}`,children:[e.jsx("span",{className:"cve-id",children:s.type==="0-day"?`0-day: ${s.title}`:s.id}),s.isKev&&e.jsx("span",{className:"kev-badge",children:"KEV"}),e.jsx("button",{type:"button",className:"cve-remove",onClick:()=>q(s.id),"aria-label":`Remove ${s.id}`,children:"Ã—"})]},s.id))}),B&&e.jsx("div",{className:"modal-overlay",onClick:()=>E(!1),children:e.jsxs("div",{className:"modal-content",onClick:s=>s.stopPropagation(),children:[e.jsx("h3",{children:"Report 0-day Vulnerability"}),e.jsxs("form",{onSubmit:ee,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"zeroday-title",children:"Title *"}),e.jsx("input",{id:"zeroday-title",type:"text",value:v.title,onChange:s=>R({...v,title:s.target.value}),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"zeroday-description",children:"Description *"}),e.jsx("textarea",{id:"zeroday-description",value:v.description,onChange:s=>R({...v,description:s.target.value}),required:!0,rows:3})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"zeroday-systems",children:"Affected Systems"}),e.jsx("input",{id:"zeroday-systems",type:"text",value:v.affectedSystems,onChange:s=>R({...v,affectedSystems:s.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"zeroday-date",children:"Discovery Date"}),e.jsx("input",{id:"zeroday-date",type:"date",value:v.discoveryDate,onChange:s=>R({...v,discoveryDate:s.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"zeroday-severity",children:"Severity Assessment"}),e.jsxs("select",{id:"zeroday-severity",value:v.severity,onChange:s=>R({...v,severity:s.target.value}),children:[e.jsx("option",{value:"LOW",children:"Low"}),e.jsx("option",{value:"MEDIUM",children:"Medium"}),e.jsx("option",{value:"HIGH",children:"High"}),e.jsx("option",{value:"CRITICAL",children:"Critical"})]})]}),e.jsxs("div",{className:"modal-actions",children:[e.jsx("button",{type:"button",onClick:()=>E(!1),children:"Cancel"}),e.jsx("button",{type:"submit",children:"Add 0-day"})]})]})]})})]})},Q=["month","day","time"],le={month:"Month",day:"Day",time:"Time"},ce=[{value:"unknown",label:"Unknown",description:"Timestamp is unknown"},{value:"n/a",label:"N/A",description:"Not applicable"},{value:"ongoing",label:"Ongoing",description:"Event is still occurring"}],oe=({value:t,onChange:l,precision:g="day",allowRange:f=!1,allowSpecialValues:y=!1,timezone:$=Intl.DateTimeFormat().resolvedOptions().timeZone,disabled:b=!1,required:A=!1,error:V,testId:m})=>{const[u,N]=p.useState(null),[r,h]=p.useState(!1);p.useEffect(()=>{t.precision||l({...t,precision:g}),t.special_value==="unknown"?N("unknown"):t.special_value==="ongoing"?N("ongoing"):t.special_value==="n/a"?N("n/a"):t.end?N("range"):t.start&&N("single")},[]);const j=p.useCallback(a=>Q.indexOf(a),[]),D=(a,d)=>{if(!a)return"";try{const c=new Date(a),x=j(d),S=c.getFullYear(),I=String(c.getMonth()+1).padStart(2,"0"),P=String(c.getDate()).padStart(2,"0"),F=String(c.getHours()).padStart(2,"0"),Z=String(c.getMinutes()).padStart(2,"0");switch(x){case 0:return`${S}-${I}`;case 1:return`${S}-${I}-${P}`;case 2:return`${S}-${I}-${P}T${F}:${Z}`;default:return`${S}-${I}-${P}T${F}:${Z}`}}catch{return console.error("Invalid date string:",a),""}},w=(a,d)=>{if(!a)return"";try{const c=j(d);let x;switch(c){case 0:const[S,I]=a.split("-");x=new Date(parseInt(S),parseInt(I)-1,1);break;case 1:const[P,F,Z]=a.split("-");x=new Date(parseInt(P),parseInt(F)-1,parseInt(Z));break;case 2:const Y=new Date(a);x=new Date(Y.getTime()-Y.getTimezoneOffset()*6e4);break;default:x=new Date(a)}return x.toISOString()}catch{return console.error("Error parsing input date:",a),""}},T=a=>{switch(j(a)){case 0:return"month";case 1:return"date";case 2:return"datetime-local";default:return"datetime-local"}},U=a=>{l({...t,precision:a,special_value:void 0})},O=a=>{const d=a.target.value;if(!d){l({...t,start:void 0});return}const c=w(d,t.precision);l({...t,start:c,special_value:void 0})},z=a=>{const d=a.target.value;if(!d){l({...t,end:void 0});return}const c=w(d,t.precision);l({...t,end:c,special_value:void 0})},k=a=>{switch(N(a),a){case"single":l({...t,special_value:void 0,end:void 0,start:t.start||void 0,precision:"day"});break;case"range":l({...t,special_value:void 0,start:t.start||void 0,end:t.end||t.start||void 0});break;case"unknown":l({...t,special_value:"unknown",start:void 0,end:void 0});break;case"ongoing":l({...t,special_value:"ongoing",start:void 0,end:void 0});break;case"n/a":l({...t,special_value:"n/a",start:void 0,end:void 0});break}},B=()=>{if(t.special_value){const a=ce.find(d=>d.value===t.special_value);return a?a.label:t.special_value}if(!t.start)return"Not Set";try{const a=new Date(t.start),d=j(t.precision);let c={timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone};switch(d){case 0:c={...c,year:"numeric",month:"long"};break;case 1:c={...c,year:"numeric",month:"short",day:"numeric"};break;case 2:c={...c,year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!1};break}let x=a.toLocaleDateString(void 0,c);if(t.end&&u==="range"){const I=new Date(t.end).toLocaleDateString(void 0,c);x+=` â†’ ${I}`}return x}catch(a){return console.error("Error formatting display value:",a),"Invalid Date"}},E=()=>{if(!t.start||!t.end||u!=="range")return null;try{const a=new Date(t.start);return new Date(t.end)<a?"End date must be after start date":null}catch{return"Invalid date range"}},v=()=>!!(t.start||t.special_value),R=()=>A&&!v()?"This field is required":null,M=E(),n=R(),i=[{value:"single",label:"Single"},{value:"range",label:"Range"},{value:"unknown",label:"Unknown"},{value:"ongoing",label:"Ongoing"},{value:"n/a",label:"N/A"}];return e.jsxs("div",{className:"datetime-picker","data-testid":m,children:[e.jsxs("div",{className:"datetime-help-button",children:[e.jsx("button",{type:"button",className:"help-icon",onClick:()=>h(!r),title:"DateTime Help","aria-expanded":r,children:"?"}),r&&e.jsxs("div",{className:"datetime-help-content",children:[e.jsx("h4",{children:"DateTime Precision Guide"}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Month:"})," Known to month precision (longer periods covered by Range)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Day:"})," Known to day precision"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Time:"})," Known to hour and minute precision"]})]}),e.jsx("h4",{children:"Mode Options"}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Single:"})," Single date/time"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Range:"})," Date/time range"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Unknown:"})," Timestamp is unknown"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Ongoing:"})," Event is still occurring"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"N/A:"})," Not applicable"]})]})]})]}),e.jsx("div",{className:"datetime-mode-control",children:e.jsx("div",{className:"segmented-button-group",children:i.map(a=>e.jsx("button",{type:"button",className:`segmented-button ${u===a.value?"active":""}`,onClick:()=>k(a.value),disabled:b,children:a.label},a.value))})}),(u==="single"||u==="range")&&e.jsx("div",{className:"datetime-precision-control",children:e.jsx("div",{className:"segmented-button-group",children:Q.map(a=>e.jsx("button",{type:"button",className:`segmented-button ${t.precision===a?"active":""}`,onClick:()=>U(a),disabled:b,children:le[a]},a))})}),(u==="single"||u==="range")&&e.jsxs("div",{className:"datetime-inputs",children:[e.jsxs("div",{className:"datetime-input-group",children:[e.jsx("label",{htmlFor:`start_${m}`,children:u==="range"?"Start Date":"Date/Time"}),e.jsx("input",{id:`start_${m}`,type:T(t.precision),className:"datetime-input",value:t.start?D(t.start,t.precision):"",onChange:O,disabled:b})]}),u==="range"&&e.jsxs("div",{className:"datetime-input-group",children:[e.jsx("label",{htmlFor:`end_${m}`,children:"End Date"}),e.jsx("input",{id:`end_${m}`,type:T(t.precision),className:"datetime-input",value:t.end?D(t.end,t.precision):"",onChange:z,disabled:b})]})]}),e.jsxs("div",{className:"datetime-result",children:[e.jsx("strong",{children:"Result:"})," ",B()]}),(V||M||n)&&e.jsx("div",{className:"datetime-error",role:"alert",children:V||M||n})]})},_={ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,ipv6:/^(?:[0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}$|^::1$|^::$/,cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\/(?:[0-9]|[1-2][0-9]|3[0-2])$/,domain:/^[a-zA-Z0-9]([a-zA-Z0-9\-]{0,61}[a-zA-Z0-9])?(\.[a-zA-Z0-9]([a-zA-Z0-9\-]{0,61}[a-zA-Z0-9])?)*$/,email:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,userAccount:/^@?[\w\.-]+$/},X={ipv4:"IPv4 Address",ipv6:"IPv6 Address","ip-range":"IP Range",cidr:"CIDR Block",domain:"Domain",fqdn:"FQDN",email:"Email Address","user-account":"User Account",miscellaneous:"Other"},de={ipv4:"ðŸŒ",ipv6:"ðŸŒ","ip-range":"ðŸ”—",cidr:"ðŸ“¡",domain:"ðŸ ",fqdn:"ðŸ¢",email:"ðŸ“§","user-account":"ðŸ‘¤",miscellaneous:"â“"},J={attacker:"#dc3545",victim:"#007bff",unknown:"#6c757d"},ue=({value:t=[],onChange:l,placeholder:g="Enter IP address, domain, email, or user account",allowedTypes:f,defaultClassification:y="unknown",maxEntries:$=50,disabled:b=!1,error:A,testId:V})=>{const[m,u]=p.useState(""),[N,r]=p.useState(""),[h,j]=p.useState(null),D=p.useRef(null),w=p.useCallback(n=>{const i=n.trim();return i.includes("-")&&T(i)?"ip-range":_.ipv4.test(i)?"ipv4":_.ipv6.test(i)?"ipv6":_.cidr.test(i)?"cidr":_.email.test(i)?"email":i.startsWith("@")||_.userAccount.test(i)?"user-account":_.domain.test(i)&&i.includes(".")?i.startsWith("www.")||i.split(".").length>2?"fqdn":"domain":"miscellaneous"},[]),T=n=>{const i=n.split("-");if(i.length!==2)return!1;const[a,d]=i.map(c=>c.trim());return _.ipv4.test(a)&&_.ipv4.test(d)},U=(n,i)=>{const a=n.trim();switch(i){case"ipv4":return _.ipv4.test(a)?null:"Invalid IPv4 address format";case"ipv6":return _.ipv6.test(a)?null:"Invalid IPv6 address format";case"cidr":return _.cidr.test(a)?null:"Invalid CIDR notation format";case"ip-range":return T(a)?null:"Invalid IP range format (use: 192.168.1.1-192.168.1.100)";case"domain":case"fqdn":return _.domain.test(a)?null:"Invalid domain format";case"email":return _.email.test(a)?null:"Invalid email format";case"user-account":return _.userAccount.test(a)?null:"Invalid user account format";case"miscellaneous":return a.length>0?null:"Value cannot be empty";default:return"Unknown asset type"}},O=n=>t.some(i=>i.value.toLowerCase()===n.toLowerCase()),z=()=>`asset-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,k=n=>{const i=m.trim();if(!i){r("Please enter an asset value");return}if(O(i)){r("This asset has already been added");return}if(t.length>=$){r(`Maximum ${$} assets allowed`);return}const a=w(i);if(f&&!f.includes(a)){r(`Asset type ${X[a]} is not allowed`);return}const d=U(i,a);if(d){r(d);return}const c={id:z(),type:a,value:i,classification:y,confidence:"medium",validated:!0};l([...t,c]),u(""),r(""),D.current?.focus()},B=n=>{l(t.filter(i=>i.id!==n))},E=(n,i)=>{l(t.map(a=>a.id===n?{...a,...i}:a))},v=n=>{n.key==="Enter"?(n.preventDefault(),k()):n.key==="Escape"&&(u(""),r(""))},R=n=>{n.preventDefault();const a=n.clipboardData.getData("text").split(/[\s,\n]+/).map(x=>x.trim()).filter(x=>x.length>0);let d=0;const c=[];a.forEach(x=>{if(O(x)||t.length+d>=$)return;const S=w(x);if(f&&!f.includes(S)||U(x,S))return;const I={id:z(),type:S,value:x,classification:y,confidence:"medium",validated:!0};c.push(I),d++}),d>0?(l([...t,...c]),r(`Added ${d} asset(s)`)):r("No valid assets found in pasted content")},M=n=>{j(h===n?null:n)};return e.jsxs("div",{className:"internet-asset-input-container","data-testid":V,children:[e.jsxs("div",{className:"asset-input-row",children:[e.jsx("input",{ref:D,type:"text",className:"asset-input-field",placeholder:g,value:m,onChange:n=>{u(n.target.value),r("")},onKeyDown:v,onPaste:R,disabled:b}),e.jsx("button",{type:"button",className:"add-asset-button",onClick:()=>k(),disabled:b||!m.trim(),children:"Add"})]}),(N||A)&&e.jsx("div",{className:"asset-validation-message",role:"alert",children:N||A}),e.jsx("div",{className:"asset-tags-container",children:t.map(n=>e.jsxs("div",{className:`asset-tag ${h===n.id?"expanded":""}`,children:[e.jsxs("div",{className:"asset-tag-header",onClick:()=>M(n.id),children:[e.jsxs("div",{className:"asset-main-info",children:[e.jsx("span",{className:"asset-icon",children:de[n.type]}),e.jsx("span",{className:"asset-value",children:n.value}),e.jsx("span",{className:"asset-classification",style:{backgroundColor:J[n.classification],color:"white"},children:n.classification})]}),e.jsxs("div",{className:"asset-actions",children:[e.jsx("button",{type:"button",className:"expand-button","aria-label":`${h===n.id?"Collapse":"Expand"} details for ${n.value}`,children:h===n.id?"â–²":"â–¼"}),e.jsx("button",{type:"button",className:"remove-asset-button",onClick:i=>{i.stopPropagation(),B(n.id)},"aria-label":`Remove ${n.value}`,children:"Ã—"})]})]}),h===n.id&&e.jsxs("div",{className:"asset-details",children:[e.jsxs("div",{className:"detail-row",children:[e.jsx("label",{children:"Type:"}),e.jsx("span",{children:X[n.type]})]}),e.jsxs("div",{className:"detail-row",children:[e.jsx("label",{children:"Classification:"}),e.jsxs("select",{value:n.classification,onChange:i=>E(n.id,{classification:i.target.value}),disabled:b,children:[e.jsx("option",{value:"attacker",children:"Attacker"}),e.jsx("option",{value:"victim",children:"Victim"}),e.jsx("option",{value:"unknown",children:"Unknown"})]})]}),e.jsxs("div",{className:"detail-row",children:[e.jsx("label",{children:"Confidence:"}),e.jsxs("select",{value:n.confidence,onChange:i=>E(n.id,{confidence:i.target.value}),disabled:b,children:[e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"high",children:"High"})]})]}),n.type==="user-account"&&e.jsxs("div",{className:"detail-row",children:[e.jsx("label",{children:"Service:"}),e.jsx("input",{type:"text",placeholder:"e.g., Active Directory, Twitter, Gmail",value:n.service||"",onChange:i=>E(n.id,{service:i.target.value}),disabled:b})]}),e.jsxs("div",{className:"detail-row",children:[e.jsx("label",{children:"Description:"}),e.jsx("textarea",{placeholder:"Additional context or notes about this asset",value:n.description||"",onChange:i=>E(n.id,{description:i.target.value}),disabled:b,rows:2})]})]})]},n.id))}),t.length>0&&e.jsxs("div",{className:"asset-summary",children:[e.jsxs("span",{className:"asset-count",children:[t.length," asset",t.length!==1?"s":""]}),e.jsx("div",{className:"classification-breakdown",children:Object.entries(J).map(([n,i])=>{const a=t.filter(d=>d.classification===n).length;return a===0?null:e.jsxs("span",{className:"classification-count",style:{backgroundColor:i,color:"white"},children:[n,": ",a]},n)})})]})]})},me=({question:t,value:l,onChange:g,error:f,disabled:y=!1,showHint:$=!1,className:b,testId:A})=>{const V=()=>{const m={id:`question_${t.id}`,disabled:y,"data-testid":A||`question-${t.id}`,"aria-describedby":f?`error_${t.id}`:void 0,"aria-invalid":!!f};switch(t.type){case"text":case"text_short":return e.jsx("input",{...m,type:"text",className:"question-input question-input--text",placeholder:t.placeholder,value:l||"",onChange:r=>g(r.target.value),maxLength:t.validation?.max_length,minLength:t.validation?.min_length});case"textarea":case"text_long":return e.jsxs("div",{className:"textarea-container",children:[e.jsx("textarea",{...m,className:"question-input question-input--textarea",placeholder:t.placeholder,value:l||"",onChange:r=>g(r.target.value),rows:t.type==="textarea"?6:4,maxLength:t.validation?.max_length,minLength:t.validation?.min_length}),t.validation?.max_length&&e.jsxs("div",{className:"character-count",children:[(l||"").length," / ",t.validation.max_length]})]});case"number":return e.jsx("input",{...m,type:"number",className:"question-input question-input--number",placeholder:t.placeholder,value:l||"",onChange:r=>g(r.target.value?Number(r.target.value):""),min:t.validation?.min_value,max:t.validation?.max_value});case"single_select":return e.jsx("div",{className:"radio-group",role:"radiogroup","aria-labelledby":`label_${t.id}`,children:t.options?.map((r,h)=>e.jsxs("label",{className:"radio-option",children:[e.jsx("input",{type:"radio",id:`question_${t.id}_${h}`,name:`question_${t.id}`,value:r.value,checked:l===r.value,onChange:j=>g(j.target.value),disabled:y,"aria-describedby":f?`error_${t.id}`:void 0,"aria-invalid":!!f}),e.jsx("span",{className:"radio-label",children:r.label}),r.description&&e.jsx("span",{className:"option-description",children:r.description})]},r.value))});case"multi_select":return e.jsx("div",{className:"checkbox-group",role:"group","aria-labelledby":`label_${t.id}`,children:t.options?.map((r,h)=>{const j=Array.isArray(l)&&l.includes(r.value);return e.jsxs("label",{className:"checkbox-option",children:[e.jsx("input",{type:"checkbox",id:`question_${t.id}_${h}`,value:r.value,checked:j,onChange:D=>{const w=Array.isArray(l)?l:[];D.target.checked?g([...w,r.value]):g(w.filter(T=>T!==r.value))},disabled:y,"aria-describedby":f?`error_${t.id}`:void 0,"aria-invalid":!!f}),e.jsx("span",{className:"checkbox-label",children:r.label}),r.description&&e.jsx("span",{className:"option-description",children:r.description})]},r.value)})});case"boolean":return e.jsx("div",{className:"boolean-toggle",children:e.jsxs("label",{className:"toggle-switch",children:[e.jsx("input",{...m,type:"checkbox",checked:l===!0,onChange:r=>g(r.target.checked)}),e.jsx("span",{className:"toggle-slider"}),e.jsx("span",{className:"toggle-label",children:l===!0?"Yes":"No"})]})});case"scale":const u=t.validation?.min_value||1,N=t.validation?.max_value||10;return e.jsxs("div",{className:"scale-input",children:[e.jsx("input",{...m,type:"range",className:"scale-slider",min:u,max:N,step:"1",value:l||u,onChange:r=>g(Number(r.target.value))}),e.jsxs("div",{className:"scale-labels",children:[e.jsx("span",{children:u}),e.jsx("span",{className:"scale-current",children:l||u}),e.jsx("span",{children:N})]})]});case"cve":case"cve_input":return e.jsx(re,{value:l||[],onChange:g,placeholder:t.placeholder,allowZeroDay:!0,maxEntries:t.allow_multiple?void 0:1,disabled:y,error:f,testId:A});case"datetime":case"datetime_range":return e.jsx(oe,{value:l||{precision:t.default_precision||"day"},onChange:g,precision:t.default_precision||"day",allowRange:t.type==="datetime_range",allowSpecialValues:t.special_options&&t.special_options.length>0,disabled:y,error:f,testId:A});case"internet_asset":return e.jsx(ue,{value:l||[],onChange:g,placeholder:t.placeholder,defaultClassification:t.defaultClassification,maxEntries:t.allow_multiple?void 0:10,disabled:y,error:f,testId:A});case"file_upload":return e.jsxs("div",{className:"file-upload-container",children:[e.jsx("input",{...m,type:"file",className:"file-input",multiple:t.allow_multiple,onChange:r=>{const h=Array.from(r.target.files||[]);g(t.allow_multiple?h:h[0]||null)}}),e.jsx("div",{className:"file-upload-hint",children:t.allow_multiple?"Select multiple files...":"Select a file..."})]});default:return e.jsx("div",{className:"unsupported-question-type",children:e.jsxs("span",{children:["Unsupported question type: ",t.type]})})}};return e.jsxs("div",{className:`question-renderer ${b||""}`,children:[e.jsxs("div",{className:"question-label-container",children:[e.jsx("label",{id:`label_${t.id}`,className:`question-label ${t.required?"required":""}`,htmlFor:t.type==="single_select"||t.type==="multi_select"?`question_${t.id}_0`:`question_${t.id}`,children:t.question}),$&&t.help_text&&e.jsx("div",{className:"question-help-inline",children:e.jsx("button",{type:"button",className:"help-toggle",onClick:m=>{m.currentTarget.parentElement?.nextElementSibling?.classList.toggle("visible")},title:"Show help",children:"?"})})]}),$&&t.help_text&&e.jsx("div",{className:"help-content",children:t.help_text}),t.explanation&&e.jsx("div",{className:"question-explanation",children:t.explanation}),e.jsx("div",{className:"question-input-container",children:V()}),f&&e.jsx("div",{id:`error_${t.id}`,className:"question-error",role:"alert","aria-live":"polite",children:f})]})};export{me as Q};
